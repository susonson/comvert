<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>カタカナ多言語変換ツール</title>
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"ヒラギノ角ゴ ProN","Hiragino Kaku Gothic ProN","メイリオ",Meiryo,sans-serif;background:linear-gradient(135deg,#eef2ff,#f3e8ff);min-height:100vh;margin:0;display:flex;align-items:center;justify-content:center;padding:24px}
  .card{width:100%;max-width:760px;background:#fff;border-radius:12px;padding:24px;box-shadow:0 6px 30px rgba(20,20,50,0.08)}
  h1{margin:0 0 18px 0;font-size:20px;text-align:center}
  label{display:block;margin-bottom:8px;font-size:13px;color:#374151}
  textarea{width:100%;height:140px;padding:12px;border:1px solid #e5e7eb;border-radius:8px;resize:vertical;font-size:16px}
  button{width:100%;margin-top:12px;padding:12px;border-radius:8px;border:0;background:#2563eb;color:#fff;font-weight:600;cursor:pointer}
  .out{margin-top:16px;padding:14px;border-radius:8px;border:1px solid #e5e7eb;background:#fbfeff;min-height:56px;white-space:pre-wrap;font-size:18px}
  .note{margin-top:10px;font-size:12px;color:#6b7280}
</style>
</head>
<body>
<div class="card">
  <h1>カタカナ多言語変換ツール</h1>
  <label for="input">カタカナまたはひらがなを入力してください</label>
  <textarea id="input" placeholder="例: ドラゴン、キャラ、ぴゅあ"></textarea>
  <button id="go">変換する</button>
  <div id="output" class="out"></div>
  <div class="note">各文字がランダムに「romaji / ひらがな / カタカナ / ハングル / キリル文字」のいずれかに変換されます</div>
</div>

<script src="table.js"></script>
<script>
  function isHiragana(ch){
    const c = ch.charCodeAt(0);
    return (0x3041 <= c && c <= 0x3096);
  }
  function hiraToKata(str){
    let out = '';
    for(let i=0;i<str.length;i++){
      const c = str.charCodeAt(i);
      if(0x3041 <= c && c <= 0x3096){
        out += String.fromCharCode(c + 0x60);
      } else {
        out += str[i];
      }
    }
    return out;
  }
  function convertText(text){
    const table = window.conversionTable || {};
    let result = '';
    let i = 0;
    while(i < text.length){
      const two = text.slice(i, i+2);
      let matched = null;
      if(table[two]) matched = {key: two, entry: table[two], len:2};
      if(!matched){
        const twoK = hiraToKata(two);
        if(table[twoK]) matched = {key: twoK, entry: table[twoK], len:2};
      }
      if(matched){
        const scripts = ['romaji','hiragana','katakana','hangul','cyrillic'];
        const s = scripts[Math.floor(Math.random()*scripts.length)];
        result += (matched.entry[s] || matched.entry.katakana || matched.entry.hiragana || matched.entry.romaji || '');
        i += matched.len;
        continue;
      }
      const one = text[i];
      let oneKey = one;
      if(!table[oneKey] && isHiragana(one)) oneKey = String.fromCharCode(one.charCodeAt(0)+0x60);
      const entry = table[oneKey];
      if(entry){
        const scripts = ['romaji','hiragana','katakana','hangul','cyrillic'];
        const s = scripts[Math.floor(Math.random()*scripts.length)];
        result += (entry[s] || entry.katakana || entry.hiragana || entry.romaji || '');
      } else {
        result += one;
      }
      i++;
    }
    return result;
  }
  document.getElementById('go').addEventListener('click',()=>{
    const v = document.getElementById('input').value || '';
    document.getElementById('output').textContent = convertText(v);
  });
  document.getElementById('input').addEventListener('keydown',(e)=>{
    if(e.key === 'Enter' && (e.metaKey || e.ctrlKey)){
      e.preventDefault();
      document.getElementById('go').click();
    }
  });
</script>
</body>
</html>
